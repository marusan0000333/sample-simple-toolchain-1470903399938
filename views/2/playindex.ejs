<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bousai-Go</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<!-- JavaScriptの読み込み -->
<!--	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBzTNCHkW3ihWvX1qK5X21mIF6RIJg0hUo"></script> -->

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type='text/javascript'>
  //
rendererOptions = {
	draggable: true,
	preserveViewport:false
};
var directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
var directionsService = new google.maps.DirectionsService();

  var mapCanvas;
var tokyo = new google.maps.LatLng(35.689614,139.691585);
var osaka = new google.maps.LatLng(34.686272,135.519649);
var def = new google.maps.LatLng(35.679413,139.786198);

function setTokyo() {
  mapCanvas.setCenter(tokyo);
}
function setOsaka() {
  mapCanvas.setCenter(osaka);
}
function setDefault() {
  mapCanvas.setCenter(def);
}

  function calcRoute() {
	 var request = {
		 origin: "IBM箱崎",
		 destination: "中央区立有馬小学校",
		 travelMode: google.maps.DirectionsTravelMode.WALKING,
		 unitSystem: google.maps.DirectionsUnitSystem.METRIC,
		// optimizeWaypoints: true,
		 provideRouteAlternatives: true,
		 avoidHighways: false,
		 avoidTolls: false
	 };
	 directionsService.route(request,
		  function(response,status){
			  if (status == google.maps.DirectionsStatus.OK){
			  directionsDisplay.setDirections(response);}
		  });
     mapCanvas.setZoom(20);
  }

  function initialize(){
    //地図を作成する
    var mapOptions = {
      zoom : 1,
      mapTypeId : google.maps.MapTypeId.ROADMAP
    };
    var mapDiv = document.getElementById("map_canvas");
    mapCanvas = new google.maps.Map(mapDiv, mapOptions);

    //
    directionsDisplay.setMap(mapCanvas);

    google.maps.event.addListener(directionsDisplay,
      'directions_changed', function(){
    });
    calcRoute();

    //ストリートビューオブジェクトの作成
    //〒103-0015 東京都中央区日本橋箱崎町１８-２４ 35.679413, 139.786198

    var streetViewDiv = document.getElementById("streetview_canvas");
    var streetViewOptions = {
      position : new google.maps.LatLng(35.679413, 139.786198)
    };
    var streetView = new google.maps.StreetViewPanorama(streetViewDiv, streetViewOptions);
    
    //地図とストリートビューを連動する
    mapCanvas.setStreetView(streetView);
    
    //ストリートビューの位置を地図と連動する
    mapCanvas.bindTo("center", streetView, "position");
    
    //ストリートビューの青いレイヤーを表示する
    //(http://googlemaps.googlermania.com/google_maps_api_v3/ja/map_example_streetview_layer.html)
    var streetViewLayer = new google.maps.ImageMapType({
      getTileUrl : function(coord, zoom) {
        return "http://www.google.com/cbk?output=overlay&zoom=" + zoom + "&x=" + coord.x + "&y=" + coord.y + "&cb_client=api";
      },
      tileSize: new google.maps.Size(256, 256)
    });
    mapCanvas.overlayMapTypes.insertAt(0, streetViewLayer);


  }
  google.maps.event.addDomListener(window, "load", initialize);
 
 </script>




  </head>
  <body onload="initialize()">
    <div class="container">
      <h1>クエスト作成<small> / 更新日時：2016/6/1 14:01:30</small></h1>
	<p>ゲームを作ってボウサイを学ぼう。災害を想像してゲームを作成する体験を”DIG”を体験しましょう。</p>

	<br>
        <label for="title">クエスト名</label> 
        <input type="text" class="form-control" id="game_name" name="game_name" maxlength='28' placeholder="ゲーム名" value="デモ用ゲーム１" readonly>
	<br>

	<h2>避難プロローグ</h2>
      <div class="form-group">
        <label for="title">日時・天気・気温</label> 
        <input type="text" class="form-control" id="game_templ" name="game_templ" maxlength='28' placeholder="季節" value="2016/8/1 16:00頃　晴れ　31度" readonly>
	<br>
        <label for="title">被災場所</label> 
        <input type="text" class="form-control" id="game_field" name="game_field" maxlength='28' placeholder="場所" value="箱崎ビル室内" readonly>
	<br>
        <label for="title">状況</label> 
        <input type="text" class="form-control" id="game_situ" name="game_situ" maxlength='28' placeholder="状況" value="車椅子生活。仕事しているとき。役に立ちそうなのはカバンに飲み物のみ。" readonly>
      </div>

	<h2>避難ルート</h2>
 <div class="form-group" style="position: relative;  width: 100%; height: 300px">
  <div id="streetview_canvas"  style="position: absolute; z-index: 1; width: 100%; height: 300px"></div>
  <div id="map_canvas" style="position: absolute; z-index: 2; width: 200px; height: 200px"></div>
  <img src="https://sample-simple-toolchain-1470903399938.mybluemix.net/static/images/img-pic.png" height="40px" width="40px" border="1" style="position: absolute; z-index: 3; bottom:0%; right:10px;" onclick="setTokyo();">
  <img src="https://sample-simple-toolchain-1470903399938.mybluemix.net/static/images/img-pic2.png" height="40px" width="40px" border="1" style="position: absolute; z-index: 4; bottom:0%; right:50px;"  onclick="setOsaka();">
  <img src="https://sample-simple-toolchain-1470903399938.mybluemix.net/static/images/newapp-icon.png" height="40px" width="40px" border="1" style="position: absolute; z-index: 5; bottom:0%; right:100px;" onclick="setDefault();">
 </div>

	<p style="position:static;">IBM箱崎ビルから中央区立有馬小学校（防災拠点）までのルートを表示。
	経路はドラッグ＆ドロップすると経路を変更できます</p>
	</br>

	<h2>チェックポイントクイズ</h2>
	<p>避難途中にチェックポイントをおいて、ボウサイカードをもちいたクイズに回答します</p>
	<p>残課題１：「クイズとなるシチュエーション（状況変化説明：夜になってきました。→クイズ：毛布の質問）といったシミュレーションゲームにしたい</p>
	<p>残課題２：回答したカードをGetするコレクター機能。コレクトしたカードによって擬人プレイヤーの敬称が変わるような成長を感じられるもの</p>
	<p>残課題３：遊ぶ際には、参加者に擬人プレイヤーを与えて、体力低下やアイテムなどの要素を加えて、リアルなゲームとしたい（（絶体絶命都市のような）</p>
	<p>残課題４：マルチプレイによる協力プレイを考えたい</p>

      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th class="col-sm-8">カード名</th>
              <th class="col-sm-3 text-center">更新日時</th>
            </tr>
          </thead>
          <tbody>
            <% list.forEach(function(row) { %>
            <tr>
              <td>
                <a href="#" data-remote="/memos2/<%= row.id %>" data-toggle="modal" data-target="#dialog" data-backdrop="static" data-keyboard="false"><%= row.title %></a>
              </td>
              <td class="text-center">
                <%= row.updatedAt %>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
      <div class="modal" id="dialog" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content"></div>
        </div>
      </div>
    </div>
  <div class="modal-footer">
    <p>デモ版では下記ボタンは使用できません</p>
    <button type="button" class="btn btn-primary">クエスト終了</button>
    <button type="button" class="btn btn-primary">キャンセル</button>
  </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $(document).on("hidden.bs.modal", function(event) {
          $(event.target).removeData("bs.modal").find(".modal-content").empty();
        });
      });
    </script>
  </body>
</html>