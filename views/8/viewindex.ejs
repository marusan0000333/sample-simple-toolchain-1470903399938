<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bousai-Go</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<!-- JavaScriptの読み込み -->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBzTNCHkW3ihWvX1qK5X21mIF6RIJg0hUo"></script>

  </head>
  <body onload="initialize()">
    <div class="container">
      <h1>被災なう<small> / XYZ市</small></h1>
	<p>今、被災しても大丈夫ですか？不安な人向けにまちのボウサイ状態を可視化しました。この情報は全国の小学生～高校生が作っています。</p>
	<p>被災したら最新の災害警報を入手できる <a href="https://www.google.org/crisisresponse/japan/index?hl=ja">Google 災害情報</a>で、最新情報を取得してください。
	</p>

	<script type="text/javascript">
	  if (navigator.geolocation) {

	    // 現在の位置情報を取得
	    navigator.geolocation.getCurrentPosition(

	      // （1）位置情報の取得に成功した場合
	      function (pos) {
	        var location ="<li>"+"緯度：" + pos.coords.latitude + "</li>";
	        location += "<li>"+"経度：" + pos.coords.longitude + "</li>";
	        document.getElementById("location").innerHTML = location;
		//必要ならHTMLに以下を記載
		//<ul id="location"></ul>
	      },
	      // （2）位置情報の取得に失敗した場合
	      function (error) {
	        var message = "";

	        switch (error.code) {

	          // 位置情報が取得できない場合
	          case error.POSITION_UNAVAILABLE:
	            message = "位置情報の取得ができませんでした。";
	            break;

	          // Geolocationの使用が許可されない場合
	          case error.PERMISSION_DENIED:
	            message = "位置情報取得の使用許可がされませんでした。";
	            break;

	          // タイムアウトした場合
	          case error.PERMISSION_DENIED_TIMEOUT:
	            message = "位置情報取得中にタイムアウトしました。";
	            break;
	        }
	        window.alert(message);
	      }
	    );
	  } else {
	    window.alert("本ブラウザではGeolocationが使えません");
	  }
	</script>


	<br>


	<h2>避難経路</h2>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script><script>
		rendererOptions = {
			draggable: true,
			preserveViewport:false
		};
		var directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
		var directionsService = new google.maps.DirectionsService();
		var map;

		function initialize() {
			 var zoom = 18;
			 var mapTypeId = google.maps.MapTypeId.ROADMAP

			 var opts = {
			 zoom: zoom,
			 mapTypeId: mapTypeId
			 };
			 map = new google.maps.Map
			 (document.getElementById("map_canvas"),opts);
			   directionsDisplay.setMap(map);

			 google.maps.event.addListener(directionsDisplay,
			   'directions_changed', function(){
			 });
			 calcRoute();
		}

		function calcRoute() {
			 var request = {
				 origin: "IBM箱崎",
				 destination: "中央区立有馬小学校",
				 travelMode: google.maps.DirectionsTravelMode.WALKING,
				 unitSystem: google.maps.DirectionsUnitSystem.METRIC,
				// optimizeWaypoints: true,
				 provideRouteAlternatives: true,
				 avoidHighways: false,
				 avoidTolls: false
			 };
			 directionsService.route(request,
				  function(response,status){
					  if (status == google.maps.DirectionsStatus.OK){
					  directionsDisplay.setDirections(response);}
				  });
		}
	</script>

	<div id="map_canvas" style="width:90%; height:300px"></div>

	<p>今の場所から避難場所までのルートを表示。
	経路はドラッグ＆ドロップすると経路を変更できます</p>


	<h2>情報リスト</h2>
	<p>今いる近くにあるボウサイカードを表示します。（公開フラグが立っている情報のみ公開する予定だが、デモ版ではすべて表示されます）</p>

      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th class="col-sm-8">カード名</th>
              <th class="col-sm-3 text-center">更新日時</th>
            </tr>
          </thead>
          <tbody>
            <% list.forEach(function(row) { %>
            <tr>
              <td>
                <a href="#" data-remote="/memos8/<%= row.id %>" data-toggle="modal" data-target="#dialog" data-backdrop="static" data-keyboard="false"><%= row.title %></a>
              </td>
              <td class="text-center">
                <%= row.updatedAt %>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table>
      </div>


	<h2>私はXXです</h2>
	<p>観光に行くときに、自分が誰かを証明するもの（避難用のトリアージのようなもの）を保持しておきましょう。</p>
	<a href="https://www.gotokyo.org/jp/administration/h24/saigaiji.html">参考：外国人旅行者の安全確保のための災害時初動対応マニュアル</a>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th class="col-sm-8">項目</th>
              <th class="col-sm-3 text-center">内容</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                名前
              </td>
              <td class="text-center">
                山田アラン太郎
              </td>
            </tr>
              <td>
                性別
              </td>
              <td class="text-center">
                男
              </td>
            </tr>
            <tr>
              <td>
                国籍
              </td>
              <td class="text-center">
                フランス
              </td>
            </tr>
            <tr>
              <td>
                宗教
              </td>
              <td class="text-center">
                キリスト教
            </tr>
            <tr>
              <td>
                アレルギー
              </td>
              <td class="text-center">
                パイナップル
              </td>
            </tr>
            <tr>
              <td>
                持病
              </td>
              <td class="text-center">
                半身不随
              </td>
            </tr>
          </tbody>
        </table>
      </div>

	<h2>もしも被災したら、、被災情報共有</h2>
	 <p>自分の近くにいる同一国や関係者と情報を交換しましょう。（外国人旅行者向けサービス）</p>

        <label>国</label> 
	<br>
	<select name="question_class" id="question_class">
		<option value="JP">日本</option>
		<option value="FR">フランス</option>
	</select>
	<br>
	<br>
	<textarea id="LatestNews" cols="70" rows="1">工事中の場合はどうやって迂回するんだ</textarea>
	<input type="button" id="askButton" value="音" onClick="askQuestion()">
        <input type="button" id="askButton" value="つぶやく" onClick="askQuestion()">
	<br>
	      <div class="table-responsive">
	        <table class="table table-striped table-hover">
	          <thead>
	            <tr>
	              <th class="col-sm-8">つぶやき</th>
	              <th class="col-sm-3 text-center">発信日時</th>
	            </tr>
	          </thead>
	          <tbody>
	            <tr>
	              <td>
	                津波きたら逃げるの無理じゃないか？
	              </td>
	              <td class="text-center">
	                2016/6/1 16:00:00
	              </td>
	            </tr>
	            <tr>
	              <td>
	                防災グッズをもってイベントに参加したい
	              </td>
	              <td class="text-center">
	                2016/6/1 14:00:000
	              </td>
	            </tr>
	          </tbody>
	        </table>


	<h2>もしも被災したら、、、備品購入</h2>
	 <p>自分の現地銀行から予め決めておいたお金と振込して、避難所へ物資を調達しましょう</p>

        <label>銀行口座</label> 
	<br>
	<select name="question_class" id="question_class">
		<option value="JP">福岡銀行</option>
		<option value="FR">XXX銀行</option>
	</select>
	<br>

        <label>予約した備品</label> 
	<br>
	<select name="question_class" id="question_class">
		<option value="A">おむつ：XXXセンター、SYXスーパー</option>
		<option value="B">バナナ：YYYセンター、IIスーパー</option>
	</select>
	<br>

        <label>自分の避難した所</label> 
	<br>
	<select name="question_class" id="question_class">
		<option value="JP">XXX避難所</option>
		<option value="FR">YYY小学校</option>
	</select>
	<br>

	<br>
	<br>


      </div>

      <div class="modal" id="dialog" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content"></div>
        </div>
      </div>
    </div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $(document).on("hidden.bs.modal", function(event) {
          $(event.target).removeData("bs.modal").find(".modal-content").empty();
        });
      });
    </script>
  </body>
</html>